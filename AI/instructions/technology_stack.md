# 技術スタック (Technology Stack)

Flutterアプリケーション開発には、以下の主要ライブラリを使用します。

## 主要ライブラリ一覧

| カテゴリ | 主要ライブラリ | 役割 |
|----------|----------------|------|
| 状態管理 | riverpod, hooks_riverpod | DIコンテナとして機能し、アプリケーション全体の状態を安全に管理する。 |
| データモデル | freezed | イミュータブルなデータクラス（エンティティ）とユニオンを生成する。 |
| 画面遷移 | go_router | 型安全で宣言的なパスベースのルーティングを実現する。 |
| ローカルDB | drift | 型安全で高性能なローカルデータベースとして、オフライン対応やデータ永続化を担う。 |
| UI補助 | flutter_hooks | ウィジェットのローカル状態を簡潔に管理するためのフックを提供する。 |

## 各ライブラリの詳細

### 状態管理: Riverpod

- **riverpod**: 基本的な状態管理機能を提供
- **hooks_riverpod**: Flutter Hooksと組み合わせて使用
- **特徴**:
  - 型安全な依存性注入
  - テストしやすい設計
  - コンパイル時エラー検出
  - 自動的なメモリ管理

### データモデル: Freezed

- **用途**: エンティティとユニオン型の生成
- **特徴**:
  - イミュータブルなデータクラス
  - copyWithメソッドの自動生成
  - JSON シリアライゼーション対応
  - パターンマッチング対応

### 画面遷移: GoRouter

- **用途**: アプリケーションのルーティング管理
- **特徴**:
  - 型安全なナビゲーション
  - 宣言的なルート定義
  - ディープリンク対応
  - ネストしたルーティング

### ローカルDB: Drift

- **用途**: ローカルデータの永続化
- **特徴**:
  - 型安全なクエリビルダー
  - コンパイル時のSQL検証
  - 自動生成されるDAOクラス
  - リアクティブなクエリ（Stream対応）
  - マイグレーション管理
  - マルチプラットフォーム対応

### UI補助: Flutter Hooks

- **用途**: ウィジェットのローカル状態管理
- **特徴**:
  - useState, useEffect等のフック提供
  - ライフサイクル管理の簡素化
  - 再利用可能なロジック
  - メモリリークの防止

## 依存関係の管理

### pubspec.yaml での設定例

```yaml
dependencies:
  flutter:
    sdk: flutter
  
  # 状態管理
  riverpod: ^2.4.0
  hooks_riverpod: ^2.4.0
  flutter_hooks: ^0.20.0
  
  # データモデル
  freezed_annotation: ^2.4.0
  json_annotation: ^4.8.0
  
  # 画面遷移
  go_router: ^12.0.0
  
  # ローカルDB
  drift: ^2.14.0
  sqlite3_flutter_libs: ^0.5.0
  path_provider: ^2.1.0
  path: ^1.8.0
  
dev_dependencies:
  flutter_test:
    sdk: flutter
  
  # コード生成
  build_runner: ^2.4.0
  freezed: ^2.4.0
  json_serializable: ^6.7.0
  drift_dev: ^2.14.0
  riverpod_generator: ^2.4.0

```

## ライブラリ選定理由

### なぜRiverpodか？
- Providerの後継として設計された
- より型安全で、ランタイムエラーが少ない
- テストが書きやすい
- パフォーマンスが優秀

### なぜFreezedか？
- ボイラープレートコードの削減
- イミュータブルな設計の強制
- JSON変換の自動化
- ユニオン型のサポート

### なぜGoRouterか？
- Flutter公式推奨
- 宣言的なルーティング
- 型安全性
- ディープリンク対応

### なぜDriftか？
- 型安全性によるランタイムエラーの削減
- コンパイル時のSQL検証でバグの早期発見
- 自動生成されるDAOによる開発効率の向上
- リアクティブなクエリでUI更新の自動化
- 現在の技術スタック（Freezed、Riverpod）との高い親和性
- マイグレーション管理の自動化

### なぜFlutter Hooksか？
- Reactのフックパターンを採用
- ウィジェットの状態管理が簡潔
- 再利用可能なロジック
- メモリ管理の自動化